<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>O C√≥digo da [P]ersuas√£o</title>
  <link rel="icon" href="https://i.imgur.com/iPllVtt.jpeg" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Favicon -->
<link rel="icon" href="https://i.imgur.com/iPllVtt.jpeg" type="image/png">

<!-- Open Graph para redes sociais -->
<meta property="og:title" content="O C√≥digo da [P]ersuas√£o" />
<meta property="og:description" content="Descubra os gatilhos mentais ocultos e t√©cnicas de persuas√£o proibidas." />
<meta property="og:image" content="https://i.imgur.com/iPllVtt.jpeg" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://bigoffer.netlify.app/lp-1/" />

<!-- Para WhatsApp e Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="O C√≥digo da [P]ersuas√£o" />
<meta name="twitter:description" content="Descubra os gatilhos mentais ocultos e t√©cnicas de persuas√£o proibidas." />
<meta name="twitter:image" content="https://i.imgur.com/iPllVtt.jpeg" />

  <style>
    /* üîº Ajuste fino da posi√ß√£o do GIF, t√≠tulo e bot√µes */
.quiz-container {
  margin-top: -40px; /* sobe todo o conjunto */
}

.gif-container img {
  margin-top: -15px; /* sobe levemente o GIF */
}

.question-text {
  margin-top: -10px; /* aproxima o texto do GIF */
}

.answers, .btn-universal, #startBtn {
  margin-top: 8px; /* reduz o espa√ßamento dos bot√µes */
}

body {
      background-color: #000;
      color: #fff;
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding-top: 60px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }
 
    .gif-container {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
}

.gif-container::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(
    circle at center,
    rgba(0, 0, 0, 0) 35%,   /* centro totalmente vis√≠vel */
    rgba(0, 0, 0, 1) 60%,   /* borda j√° come√ßa a escurecer */
    rgba(0, 0, 0, 1) 100%   /* borda 100% preta */
  );
  z-index: 2;
}

.gif-container img {
  width: 100%;
  height: auto;
  max-width: 300px;
  display: block;
  margin: 0 auto;
  cursor: pointer;
  position: relative;
  z-index: 1;
}

    .hidden {
      display: none;
    }


    .answers {
  margin-top: -10px; 
}

.answers button, #startBtn, .btn-universal {
  display: block;
  background: linear-gradient(145deg, #00ffcc, #00ccff);
  color: #fff; /* branco */
  border: none;
  font-weight: bold;
  padding: 15px 25px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 1.1em;
  margin: 15px auto;
  width: 90%;
  max-width: 320px;
  text-align: center;
  box-shadow: 0 0 15px rgba(0,255,200,0.6);
  transition: all 0.3s ease;
  text-shadow: 
    -1px -1px 0 #676767,
     1px -1px 0 #383838,
    -1px  1px 0 #676767,
     1px  1px 0 #444444; 
}

.answers button:hover, #startBtn:hover {
  background: linear-gradient(145deg, #00ffcc, #00ccff);
  box-shadow: 0 0 25px rgba(0,255,200,0.9);
  transform: scale(1.05);
}

.btn-universal:hover {
  box-shadow: 0 0 25px rgba(0,255,200,0.9);
  transform: scale(1.05);
}

    .progress-bar-top {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: #222;
      z-index: 9999;
      overflow: hidden;
    }
    .progress-bar-fill-top {
      height: 100%;
      background: linear-gradient(to right, red 20%, #ff4d4d 50%, red 80%);
      width: 10%; /* Come√ßa em 10% */
      position: relative;
      animation: shimmer 2s infinite;
      background-size: 200% 100%;
    }
    @keyframes shimmer {
      0% { background-position: -200px 0; }
      100% { background-position: 200px 0; }
    }
    .progress-text {
      display: none;
    }
    #quizAudio {
      display: none;
    }
.question-text {
  display: none;
  text-align: center;
  font-size: 1em;          
  font-weight: bold;
  margin: 8px auto;        
  line-height: 1.3em;    
  max-width: 80%;
  color: #fff;
  text-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
}



/* üå°Ô∏è Cont√™iner geral */
#thermometer-container {
  position: fixed;
  left: 20px;
  bottom: 30px;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  z-index: 9999;
}

/* Barra principal */
#thermometer {
  width: 10px;
  height: 190px;
  background: linear-gradient(to top, #111, #1a1a1a);
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.08);
  box-shadow: 0 0 10px rgba(0,255,200,0.25);
  margin-bottom: 25px;
  position: relative;
}

.thermo-inner {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: visible; /* ‚úÖ agora a bolinha pode aparecer fora da barra */
  border-radius: 8px;
  box-shadow: inset 0 0 6px rgba(0,255,200,0.25);
}

.thermo-fill {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  background: linear-gradient(to top, #00ffcc, #00bfff);
  height: 0%;
  transition: height 1s ease-in-out;
  box-shadow: 0 0 8px rgba(0,255,200,0.5);
}

/* üîµ Bolinha ligeiramente maior e mais viva */
.thermo-bulb {
  position: absolute;
  bottom: -14px; /* ajusta para alinhar com a base */
  left: 50%;
  transform: translateX(-50%);
  width: 20px; 
  height: 20px; 
  background: radial-gradient(circle at 30% 30%, #00ffcc, #00bfff); /* mesma cor do preenchimento */
  border-radius: 50%;
  box-shadow: 0 0 18px rgba(0,255,200,0.9); /* brilho refor√ßado */
  border: 1px solid rgba(0,255,200,0.3);
  z-index: 3;
}

/* üîÅ Seta √† direita, apontando para a esquerda */
.thermo-arrow {
  position: absolute;
  right: -10px; 
  top: calc(100% - 18%);
  width: 0;
  height: 0;
  border-top: 4px solid transparent;
  border-bottom: 4px solid transparent;
  border-right: 6px solid #fff; 
  opacity: 0.7;
  filter: drop-shadow(0 0 2px rgba(255,255,255,0.5));
  transition: top 1s ease-in-out;
}

/* Texto fixo no rodap√© */
#thermo-label {
  font-size: 0.65em;
  color: rgba(255,255,255,0.65);
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 500;
  text-shadow: 0 0 6px rgba(0,255,200,0.25);
}





/* üí• Efeito de desintegra√ß√£o */
.disintegration-effect {
  position: fixed;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  z-index: 99999;
}

.particle {
  position: absolute;
  width: 3px;
  height: 3px;
  background: rgba(0,255,200,0.8);
  border-radius: 50%;
  animation: disperse 1.5s linear forwards;
}

/* üîπ Anima√ß√£o sem Math.random(), controlada via JS */
@keyframes disperse {
  from {
    transform: scale(1) translate(0, 0);
    opacity: 1;
  }
  to {
    transform: scale(0) translate(var(--x), var(--y));
    opacity: 0;
  }
}

  </style>


<!-- üîµ Meta Pixel Code -->
<script>
  !(function(f,b,e,v,n,t,s){
    if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)n._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)
  })(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');

  fbq('init', '839138854780074'); // ‚úÖ seu pixel
  fbq('track', 'ViewContent');
</script>
<noscript>
  <img height="1" width="1" style="display:none"
       src="https://www.facebook.com/tr?id=839138854780074&ev=ViewContent&noscript=1"/>
</noscript>
<!-- End Meta Pixel Code -->

</head>
<body>


<!-- üåÄ POPUP DE IN√çCIO -->
<div id="startOverlay" class="overlay">
  <div class="popup-glass">
    <h2>‚ö†Ô∏èATEN√á√ÉO</h2>
    <p>Antes de continuar, coloque o <b>VOLUME NO M√ÅXIMO</b> para ouvir tudo com clareza.</p>
    <button id="beginPortal" class="btn-universal">OUVIR üîä</button>
  </div>
</div>

<style>
/* üî≤ Fundo escuro com desfoque */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(6px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
}

/* üíé Caixa de vidro */
.popup-glass {
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(12px);
  border-radius: 16px;
  padding: 25px 20px;
  width: 90%;
  max-width: 280px; /* mais estreita */
  text-align: center;
  color: #fff;
  box-shadow: none; /* sem brilho */
}

/* ‚ú® Texto e bot√£o */
.popup-glass h2 {
  font-size: 1.3em;
  margin-bottom: 10px;
}

.popup-glass p {
  font-size: 0.95em;
  line-height: 1.4em;
  color: #ddd;
  margin-bottom: 20px;
}

#volumeHint {
  position: absolute;
  bottom: -22px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 13px;
  color: #ffffff; /* branco puro */
  font-weight: 500;
  text-shadow: 0 0 8px rgba(255, 255, 255, 0.7);
  opacity: 0;
  animation: blink 1.2s ease-in-out infinite, fadeOut 5s ease forwards;
  pointer-events: none;
}

@keyframes blink {
  0%, 100% { opacity: 0.2; }
  50% { opacity: 1; }
}

@keyframes fadeOut {
  0% { opacity: 1; }
  90% { opacity: 0.9; }
  100% { opacity: 0; visibility: hidden; }
}

</style>

<script>
document.getElementById("beginPortal").addEventListener("click", () => {
  // Fecha o aviso inicial
  document.getElementById("startOverlay").style.display = "none";

  // IMPORTANTE inicia o quiz
  if (typeof fbq === "function") {
    fbq('track', 'Lead');
    console.log("üî• Evento Lead disparado!");
  }

  // Inicia o √°udio principal do quiz
  const intro = document.getElementById("introAudio");
  intro.muted = false;
  intro.play();

  // üéµ Inicia m√∫sica de fundo com volume 30%
  const bgMusic = document.getElementById("bgMusic");
  bgMusic.volume = 0.5;
  bgMusic.play().catch(err => console.log("Autoplay bloqueado at√© intera√ß√£o:", err));
});
</script>




  <div class="quiz-container">
    <div class="progress-bar-top" id="progressBar">
      <div class="progress-bar-fill-top" id="progressFillTop"></div>
    </div>

    <div class="gif-container" id="gifTop" onclick="unmuteIntro()">
      <img src="https://static.wixstatic.com/media/7f5efc_43c1c40f773b406dbfcbd0332c43715c~mv2.gif" alt="Or√°culo">
       <div id="volumeHint">‚ô´Aumente o Volume</div>
    </div>

     <audio id="introAudio" autoplay muted onended="showStartButton()">
      <source src="https://static.wixstatic.com/mp3/7f5efc_9c72927ebd644091a41f85b97a93198b.mp3" type="audio/mpeg">
      Seu navegador n√£o suporta √°udio.
    </audio>

    <button id="startBtn" onclick="startQuiz()" style="display: none;">ASSUMIR OS RISCOS</button>

    <audio id="quizAudio" onended="showOptions()">
      <source id="quizAudioSrc" src="" type="audio/mpeg">
      Seu navegador n√£o suporta √°udio.
    </audio>

    <div id="quizContent" style="display:none">
      <div class="question-text" id="questionText"></div>
      <div class="answers" id="answers" style="display:none"></div>
    </div>
  </div>

  <script>
    const questions = [
      {
        text: "Vamos l√°! Valendo...",
        options: ["Escassez", "Prova Social", "Autoridade"],
        correct: 2,
        audio: "https://static.wixstatic.com/mp3/7f5efc_6887c7208e59424ab157e31a39137b0c.mp3",
        gif: "https://static.wixstatic.com/media/7f5efc_8e1f897492c6474d880adf2ad3182ac5~mv2.gif"
      },
      {
        text: "Uma crian√ßa de 5 anos sabe!",
        options: ["Urg√™ncia", "Escassez", "Reciprocidade"],
        correct: 1,
        audio: "https://static.wixstatic.com/mp3/7f5efc_5a19d15e56a742a6992b2a3f46597638.mp3",
        gif: "https://static.wixstatic.com/media/7f5efc_a7bee9f2a76c46c4b3f33679c2bdc969~mv2.gif"
      },
      {
        text: "Eu nem chamaria de amigo...",
        options: ["Reciprocidade", "Autoridade", "Medo"],
        correct: 0,
        audio: "https://static.wixstatic.com/mp3/7f5efc_02c932a98ba940de96496fcbc7d72bd9.mp3",
        gif: "https://static.wixstatic.com/media/7f5efc_65ecff36c016466f86572c9701297323~mv2.gif"
      },
      {
        text: "Me prova que sabe...",
        options: ["Medo de Perder", "Raiva", "Recompensa"],
        correct: 2,
        audio: "https://static.wixstatic.com/mp3/7f5efc_d4565de85cfe47e182eb158a74424204.mp3",
        gif: "https://static.wixstatic.com/media/7f5efc_356fcdf2e88344ea95e2f7d8e218c018~mv2.gif"
      },
      {
        text: "Te peguei n√£o √© mesmo?",
        options: ["Antecipa√ß√£o", "Autonomia", "Chantagem"],
        correct: 1,
        audio: "https://static.wixstatic.com/mp3/7f5efc_42f722c97490452f9c83c23d29c49329.mp3",
        gif: "https://static.wixstatic.com/media/7f5efc_8e1f897492c6474d880adf2ad3182ac5~mv2.gif"
      }
    ];



    let currentQuestion = 0;

    function unmuteIntro() {
      const audio = document.getElementById("introAudio");
      audio.muted = false;
      audio.play();
      document.getElementById("gifTop").onclick = null;
    }

    function showStartButton() {
      document.getElementById("startBtn").style.display = "block";
    }

    function startQuiz() {
      document.querySelector('.gif-container').onclick = null;
      document.getElementById("startBtn").style.display = "none";
      document.getElementById("quizContent").style.display = "block";
      document.getElementById("progressBar").style.display = "block";
      playCurrentAudio();
      updateTopProgress();
       updateThermometer(); 
    }

    function playCurrentAudio() {
      const question = questions[currentQuestion];
      const quizAudio = document.getElementById("quizAudio");
      const source = document.getElementById("quizAudioSrc");
      source.src = question.audio;
      quizAudio.load();
      quizAudio.play();
      document.getElementById("gifTop").innerHTML = `<img src="${question.gif}" alt="Or√°culo">`;

      if (currentQuestion === 0 && typeof fbq === "function") {
      fbq('track', 'CompleteRegistration'); // IMPORTANTE! inicia as perguntas do quiz
      }
    }

    function showOptions() {
      const answersDiv = document.getElementById("answers");
      answersDiv.innerHTML = "";
      const question = questions[currentQuestion];
      document.getElementById("questionText").textContent = question.text;
      document.getElementById("questionText").style.display = "block";
      question.options.forEach((opt, index) => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => handleAnswer(index);
        answersDiv.appendChild(btn);
      });
      answersDiv.style.display = "block";
    }



function handleAnswer(selectedIndex) {
  currentQuestion++;

  if (currentQuestion < questions.length) {
    loadNextQuestion();
    updateThermometer();
  } else {
    // Garante que a interface zere antes de ir para o pitch final
    document.getElementById("answers").style.display = "none";
    document.getElementById("questionText").style.display = "none";
    hideThermometer();

    // D√° um pequeno delay para transi√ß√£o suave
    setTimeout(() => {
      showResult();
    }, 500);
  }
}


    function loadNextQuestion() {
      document.getElementById("answers").style.display = "none";
      document.getElementById("questionText").style.display = "none";
      playCurrentAudio();
      updateTopProgress();
    }

    function updateTopProgress() {
      const percent = ((currentQuestion + 1) / questions.length) * 100;
      document.getElementById("progressFillTop").style.width = percent + "%";
    }


    // Permitir tocar o √°udio ao clicar em qualquer lugar da tela
document.body.addEventListener("click", function playOnce() {
  unmuteIntro();
  document.body.removeEventListener("click", playOnce);
});



const finalStages = [
  {
    audio: "https://static.wixstatic.com/mp3/7f5efc_c16fb254d2164b75a55acb4b5f1f9d35.mp3",
    title: "Ainda h√° mais a descobrir...",
    gif: "https://static.wixstatic.com/media/7f5efc_e4cececd9a3d4752ac73ed9e3aa22854~mv2.gif",
    buttons: [
      { text: "Resgatar Presente", action: "continuar" }
    ]
  },
  {
    audio: "https://static.wixstatic.com/mp3/7f5efc_d08020db61c748099a1ddce786e47530.mp3",
    title: "Agora o verdadeiro jogo come√ßa.",
    gif: "https://static.wixstatic.com/media/7f5efc_8e1f897492c6474d880adf2ad3182ac5~mv2.gif",
    buttons: [
      { text: "Sim, tenho!", action: "continuar" },
      { text: "Desbloquear agora", action: "continuar" }
    ]
  },
  {
    audio: "https://static.wixstatic.com/mp3/7f5efc_6223bdff2fca421aa8f0720e0242a96e.mp3",
    title: "Est√° pronto para o poder completo?",
    gif: "https://static.wixstatic.com/media/7f5efc_65ecff36c016466f86572c9701297323~mv2.gif",
    buttons: [
      { text: "Sim, est√° claro", action: "continuar" },
      { text: "Continuar agora", action: "continuar" }
    ]
  },
  {
    audio: "https://static.wixstatic.com/mp3/7f5efc_7932cb65472544788ac6dc7ebb2a5b37.mp3",
    title: "Voc√™ se compromete?",
    gif: "https://static.wixstatic.com/media/7f5efc_8f04a0244d954ae795ddd741d52fc009~mv2.gif",
    buttons: [
      { text: "Eu me comprometo", action: "continuar" },
      { text: "Vou pensar", action: "continuar" }
    ]
  },
  
  {
  audio: "https://static.wixstatic.com/mp3/7f5efc_45087183048d4fa1a9586f0100342b08.mp3",
title: (() => {
  const dias = ["domingo", "segunda", "ter√ßa", "quarta", "quinta", "sexta", "s√°bado"];
  const hoje = new Date();
  const diaSemana = dias[hoje.getDay()];
  const dia = hoje.getDate().toString().padStart(2, '0');
  const mes = hoje.toLocaleString('pt-BR', { month: 'long' });
  return `Agora √© com voc√™... <br>
  <br>
  O portal est√° aberto para garantir o C√≥digo da [P]ersuas√£o com 70% de Desconto!<br>
  <br>
  ‚ö†Ô∏è<b>ATEN√á√ÉO:</b> Essa promo√ß√£o ficar√° dispon√≠vel somente hoje, ${diaSemana} ${dia} de ${mes}.`;
})(),
  gif: "https://static.wixstatic.com/media/7f5efc_a7bee9f2a76c46c4b3f33679c2bdc969~mv2.gif",
  buttons: [
    { text: "GARANTIR AGORA!", action: "link", link: "/lp-2/" }
  ]
}
  

];

let currentStage = 0;

/* üé¨ IMPORTANTE!  Fim das Pergutnas Inicio do Pitch */
function showResult() {
  if (typeof fbq === "function") {
    fbq('track', 'AddToWishlist');
    console.log("‚úÖ Evento disparado!");
  }

  // Continua o fluxo normal
  currentStage = 0;
  playFinalStage();
}





// üîä Som de clique
const clickSound = new Audio("https://cdn.pixabay.com/download/audio/2025/08/03/audio_1df12d5efc.mp3?filename=computer-mouse-click-02-383961.mp3");
clickSound.volume = 0.7; // volume moderado IMPROTANTE!

// Tocar o som sempre que qualquer bot√£o for clicado
document.addEventListener("click", (e) => {
  if (e.target.tagName === "BUTTON") {
    clickSound.currentTime = 0;
    clickSound.play();
  }
});

</script>






<script>

// Bloqueia pin√ßa (touchmove com 2 dedos)
document.addEventListener('touchmove', function(e) {
  if (e.touches && e.touches.length > 1) {
    e.preventDefault();
  }
}, { passive: false });

// Bloqueia duplo-toque r√°pido
let lastTouchEnd = 0;
document.addEventListener('touchend', function(e) {
  const now = Date.now();
  if (now - lastTouchEnd <= 300) {
    e.preventDefault();
  }
  lastTouchEnd = now;
}, false);

// Bloqueia gestos espec√≠ficos no iOS
document.addEventListener('gesturestart', function(e) {
  e.preventDefault();
});



// Bloqueia o menu de contexto (clique direito)
document.addEventListener('contextmenu', e => e.preventDefault());

// Impede copiar/recortar/selecionar texto
['copy','cut','selectstart','dragstart'].forEach(evt =>
  document.addEventListener(evt, e => e.preventDefault())
);

// Bloqueia atalho Ctrl+C, Ctrl+U (ver fonte), Ctrl+S, Ctrl+P e F12
document.addEventListener('keydown', e => {
  const forbidden =
    // combina√ß√µes de Ctrl + C, U, S, P, A
    (e.ctrlKey &&
      ['c','u','s','p','a'].includes(e.key.toLowerCase()))
    // F12
    || e.key === 'F12';
  if (forbidden) e.preventDefault();
});

</script>


<!-- üå°Ô∏è Term√¥metro de Inoc√™ncia -->
<div id="thermometer-container" style="display: none;">
  <div id="thermometer">
    <div class="thermo-inner">
      <div class="thermo-fill" id="thermoFill"></div>
      <div class="thermo-bulb"></div> 
      <div class="thermo-arrow"></div>
    </div>
  </div>
  <p id="thermo-label">N√≠vel de Inoc√™ncia</p>
</div>

<script>
// üå°Ô∏è Term√¥metro de Inoc√™ncia
const thermometerContainer = document.getElementById("thermometer-container");
const thermometer = document.getElementById("thermometer");
const thermoFill = document.getElementById("thermoFill");
const thermoArrow = document.querySelector(".thermo-arrow");

// Define os n√≠veis do term√¥metro em cada pergunta (0 a 100)
const thermometerLevels = [20, 55, 30, 80, 35];

function updateThermometer() {
  thermometerContainer.style.display = "flex"; // üî• Mostra o conjunto completo
  const level = thermometerLevels[currentQuestion];
  thermoFill.style.height = `${level}%`;
  thermoArrow.style.top = `${100 - level}%`;
}

function hideThermometer() {
  thermometerContainer.style.display = "none"; // üîï Esconde tudo junto
}

</script>
<!-- üéµ √Åudio de fundo -->
<audio id="bgMusic" loop>
  <source src="https://cdn.pixabay.com/download/audio/2024/05/21/audio_852c1196bc.mp3?filename=suspense-e-investigacao-hipervigilrpg-211156.mp3" type="audio/mpeg">
  Seu navegador n√£o suporta √°udio.
</audio>




<script>
// üîÑ Controle de progresso com localStorage

// üîπ Salva o progresso a cada etapa
function saveProgress() {
  const progress = {
    currentQuestion,
    currentStage,
    phase: (currentQuestion < questions.length) ? 'quiz' : 'final'
  };
  localStorage.setItem('persuasaoProgress', JSON.stringify(progress));
}

// üîπ Carrega o progresso salvo (se existir)
function loadProgress() {
  const saved = localStorage.getItem('persuasaoProgress');
  if (!saved) return null;
  try {
    return JSON.parse(saved);
  } catch {
    return null;
  }
}

// üîπ Inicializa a m√∫sica de fundo
function startBackgroundMusic() {
  const bgMusic = document.getElementById("bgMusic");
  if (!bgMusic) return;

  bgMusic.volume = 0.3;
  bgMusic.loop = true;

  const playMusic = () => {
    bgMusic.play().catch(() => {
      console.log("‚ö†Ô∏è Autoplay bloqueado ‚Äî aguardando intera√ß√£o.");
    });
  };

  // tenta tocar imediatamente (caso j√° permitido)
  playMusic();

  // garante que toque ap√≥s intera√ß√£o
  document.body.addEventListener("click", playMusic, { once: true });
}

// üîπ Restaura o estado salvo ao abrir a p√°gina
window.addEventListener('load', () => {
  const saved = loadProgress();

  // Sempre inicia a m√∫sica de fundo
  startBackgroundMusic();

  if (!saved) return;

  console.log("üîÅ Restaurando progresso:", saved);

  // Se estava no quiz
  if (saved.phase === 'quiz') {
    currentQuestion = saved.currentQuestion || 0;
    document.getElementById("startOverlay").style.display = "none";
    document.getElementById("quizContent").style.display = "block";
    document.getElementById("progressBar").style.display = "block";
    playCurrentAudio();
    updateTopProgress();
    updateThermometer();
  }

   // Se estava nas etapas finais
else if (saved.phase === 'final') {
  audioPlaying = false; // limpa estados antigos
  currentStage = saved.currentStage || 0;
  document.getElementById("startOverlay").style.display = "none";
  hideThermometer();
  playFinalStage();

  // üîä Retoma o √°udio com 1 clique se o usu√°rio voltar no pitch final
  document.body.addEventListener('click', function resumeFinalAudioOnce() {
    const stage = finalStages[saved.currentStage || 0];
    if (stage && stage.audio) {
      const resumeAudio = new Audio(stage.audio);
      resumeAudio.play().catch(err => console.log("‚ö†Ô∏è Autoplay bloqueado:", err));

      // ‚úÖ Quando o √°udio terminar, mostra os bot√µes e o texto
      resumeAudio.onended = () => {
        showStageButtons();
      };
    }

    // remove o evento ap√≥s tocar
    document.body.removeEventListener('click', resumeFinalAudioOnce);
  });
}
});

// üß© Sempre salvar quando muda de etapa
function handleAnswer(selectedIndex) {
  currentQuestion++;

  if (currentQuestion < questions.length) {
    loadNextQuestion();
    updateThermometer();
    saveProgress(); // üíæ salva o progresso
  } else {
    document.getElementById("answers").style.display = "none";
    document.getElementById("questionText").style.display = "none";
    hideThermometer();
    setTimeout(() => {
      showResult();
      saveProgress(); // üíæ salva quando termina o quiz
    }, 500);
  }
}

// üîπ Tamb√©m salvar nas etapas finais
function playFinalStage() {
  const stage = finalStages[currentStage];
  const container = document.querySelector(".quiz-container");

  container.innerHTML = `
    <div class="gif-container">
      <img src="${stage.gif}" alt="Or√°culo">
    </div>
  `;






// üåå Efeito de desintegra√ß√£o s√≥ na primeira etapa final
if (currentStage === 0) {
  const effect = document.createElement("div");
  effect.className = "disintegration-effect";
  document.body.appendChild(effect);

  for (let i = 0; i < 120; i++) {
    const particle = document.createElement("span");
    particle.className = "particle";
    particle.style.left = Math.random() * 100 + "vw";
    particle.style.top = Math.random() * 100 + "vh";
    particle.style.animationDelay = Math.random() * 1.5 + "s";
    effect.appendChild(particle);
  }

  setTimeout(() => effect.remove(), 2500); // limpa o efeito ap√≥s 2,5s
}



  const audio = new Audio(stage.audio);
  audio.play();

  // üö® Salva o est√°gio atual no localStorage
  saveProgress();

  // üéØ Evento do pixel se for a √∫ltima etapa
  if (currentStage === finalStages.length - 1) {
    fbq('track', 'Search');
    console.log("üì© Evento disparado (√∫ltima etapa)");
  }

  audio.onended = () => showStageButtons();
}






function showStageButtons() {
  const stage = finalStages[currentStage];
  const container = document.querySelector(".quiz-container");

  container.innerHTML = `
    <div class="gif-container">
      <img src="${stage.gif}" alt="Or√°culo">
    </div>
    <div class="question-text" style="display:block;">${stage.title}</div>
  `;

  // üéá Se for a √∫ltima etapa, dispara fogos e som automaticamente
  if (currentStage === finalStages.length - 1) {
    launchConfetti();

    const sound = new Audio("https://cdn.pixabay.com/download/audio/2022/03/10/audio_5b4d3bfb9e.mp3?filename=balloon-pop-48030.mp3");
    sound.volume = 0.4;
    sound.play();
  }

  stage.buttons.forEach(btnData => {
    const btn = document.createElement("button");
    btn.textContent = btnData.text;
    btn.className = "btn-universal";

    btn.onmouseenter = () => btn.style.boxShadow = "0 0 25px rgba(0,255,200,0.9)";
    btn.onmouseleave = () => btn.style.boxShadow = "0 0 15px rgba(0,255,200,0.6)";

    if (btnData.action === "continuar") {
      btn.onclick = () => {
        currentStage++;
        saveProgress();
        if (currentStage < finalStages.length) {
          playFinalStage();
        } else {
          const params = new URLSearchParams(window.location.search);
          const utmString = params.toString();
          let finalLink = "https://sun.eduzz.com/E0D6P4V691";

          if (utmString) {
            const separator = finalLink.includes('?') ? '&' : '?';
            finalLink = `${finalLink}${separator}${utmString}`;
          }

          window.location.href = finalLink;
        }
      };
    }

    else if (btnData.action === "link") {
      btn.onclick = () => {
        // apenas redireciona (efeito j√° foi disparado antes)
        const params = new URLSearchParams(window.location.search);
        const utmString = params.toString();
        let finalLink = btnData.link;

        if (utmString) {
          const separator = finalLink.includes('?') ? '&' : '?';
          finalLink = `${finalLink}${separator}${utmString}`;
        }

        setTimeout(() => {
          window.location.href = finalLink;
        }, 500);
      };
    }

    container.appendChild(btn);
  });
}



// üßπ Fun√ß√£o para limpar o progresso completamente
function resetProgress() {
  localStorage.removeItem('persuasaoProgress');
  console.log("üßπ Progresso resetado");
}

// üß≤ Se o lead clicar no bot√£o final manualmente, tamb√©m limpa
document.addEventListener('click', e => {
  if (e.target.textContent.includes("ACESSAR O C√ìDIGO")) {
    resetProgress();
  }
});
</script>


<script>
// üéÜ EFEITO DE FOGOS DE ARTIF√çCIO
function launchFireworks() {
  const fireworksContainer = document.createElement('div');
  fireworksContainer.style.position = 'fixed';
  fireworksContainer.style.inset = '0';
  fireworksContainer.style.pointerEvents = 'none';
  fireworksContainer.style.zIndex = '999999';
  document.body.appendChild(fireworksContainer);

  const colors = ['#00fff2', '#00bfff', '#ff00cc', '#ffcc00', '#ffffff'];

  for (let i = 0; i < 60; i++) {
    const particle = document.createElement('div');
    particle.style.position = 'absolute';
    particle.style.width = '4px';
    particle.style.height = '4px';
    particle.style.borderRadius = '50%';
    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
    particle.style.left = Math.random() * 100 + 'vw';
    particle.style.top = Math.random() * 100 + 'vh';
    particle.style.opacity = 1;
    particle.style.transform = 'scale(1)';
    fireworksContainer.appendChild(particle);

    const angle = Math.random() * 2 * Math.PI;
    const distance = 80 + Math.random() * 80;

    const x = Math.cos(angle) * distance;
    const y = Math.sin(angle) * distance;

    particle.animate([
      { transform: 'translate(0, 0) scale(1)', opacity: 1 },
      { transform: `translate(${x}px, ${y}px) scale(0.2)`, opacity: 0 }
    ], {
      duration: 1200 + Math.random() * 600,
      easing: 'ease-out',
      fill: 'forwards'
    });
  }

  // Remove o container ap√≥s o efeito
  setTimeout(() => fireworksContainer.remove(), 2000);
}
</script>

<!-- Biblioteca do confete (coloque no topo da p√°gina, antes da fun√ß√£o) -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

<script>
function launchConfetti() {
  // dura√ß√£o total do efeito
  var duration = 2000;
  var end = Date.now() + duration;

  // loop de anima√ß√£o
  (function frame() {
    // Confete explodindo da esquerda
    confetti({
      particleCount: 6,
      angle: 60,
      spread: 55,
      origin: { x: 0, y: 1 },
      colors: ['#00ffcc', '#00e0ff', '#00bfff', '#00aaff', '#66ffff']
    });

    // Confete explodindo da direita
    confetti({
      particleCount: 6,
      angle: 120,
      spread: 55,
      origin: { x: 1, y: 1 },
      colors: ['#00ffcc', '#00e0ff', '#00bfff', '#00aaff', '#66ffff']
    });

    if (Date.now() < end) {
      requestAnimationFrame(frame);
    }
  })();
}
</script>

</body>
</html>
